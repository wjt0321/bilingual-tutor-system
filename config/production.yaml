# ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶
# Production Environment Configuration
# 
# âš ï¸ é‡è¦å£°æ˜: æœ¬é…ç½®æ–‡ä»¶ä»…ç”¨äºä¸ªäººå­¦ä¹ ç³»ç»Ÿéƒ¨ç½²
# ä¸¥ç¦ç”¨äºä»»ä½•å•†ä¸šç”¨é€”æˆ–ä¼ä¸šçº§éƒ¨ç½²
# é…ç½®ä¸­çš„æ‰€æœ‰å‚æ•°å‡ä¸ºä¸ªäººå­¦ä¹ ç³»ç»Ÿè®¾è®¡
# 
# ğŸš« ç¦æ­¢å•†ä¸šä½¿ç”¨: æœ¬é…ç½®ä¸å¾—ç”¨äºå•†ä¸šç³»ç»Ÿéƒ¨ç½²
# ğŸ“ ä»…é™ä¸ªäººå­¦ä¹ : é…ç½®ä»…æ”¯æŒä¸ªäººè¯­è¨€å­¦ä¹ åŠŸèƒ½
# âš–ï¸ æ³•å¾‹è´£ä»»: è¿è§„ä½¿ç”¨åæœè‡ªè´Ÿ

# åº”ç”¨ç¨‹åºé…ç½®
app:
  name: "åŒè¯­å¯¼å¸ˆç³»ç»Ÿ"
  version: "1.0.0"
  environment: "production"
  debug: false
  secret_key: "${SECRET_KEY}"  # ä»ç¯å¢ƒå˜é‡è·å–
  host: "0.0.0.0"
  port: 5000
  workers: 4  # Gunicorn worker è¿›ç¨‹æ•°

# æ•°æ®åº“é…ç½®
database:
  type: "sqlite"
  path: "/app/data/learning.db"
  backup_path: "/app/backups/"
  backup_interval: 86400  # 24å°æ—¶å¤‡ä»½ä¸€æ¬¡
  connection_pool_size: 20
  timeout: 30
  
  # æ•°æ®åº“ä¼˜åŒ–è®¾ç½®
  pragma:
    journal_mode: "WAL"
    synchronous: "NORMAL"
    cache_size: 10000
    temp_store: "MEMORY"

# ç¼“å­˜é…ç½®
cache:
  type: "redis"
  host: "${REDIS_HOST:-localhost}"
  port: "${REDIS_PORT:-6379}"
  db: "${REDIS_DB:-0}"
  password: "${REDIS_PASSWORD}"
  max_connections: 50
  socket_timeout: 5
  socket_connect_timeout: 5
  retry_on_timeout: true
  
  # ç¼“å­˜ç­–ç•¥
  default_ttl: 3600  # 1å°æ—¶
  session_ttl: 86400  # 24å°æ—¶
  content_ttl: 7200   # 2å°æ—¶
  user_data_ttl: 1800 # 30åˆ†é’Ÿ

# æ—¥å¿—é…ç½®
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  # æ–‡ä»¶æ—¥å¿—
  file:
    enabled: true
    path: "/app/logs/"
    filename: "bilingual_tutor.log"
    max_size: "100MB"
    backup_count: 10
    rotation: "daily"
  
  # æ§åˆ¶å°æ—¥å¿—
  console:
    enabled: true
    level: "WARNING"
  
  # é”™è¯¯æ—¥å¿—
  error:
    enabled: true
    path: "/app/logs/"
    filename: "error.log"
    level: "ERROR"

# å®‰å…¨é…ç½®
security:
  # å¯†ç åŠ å¯†
  password_hash_rounds: 12
  
  # ä¼šè¯å®‰å…¨
  session_cookie_secure: true
  session_cookie_httponly: true
  session_cookie_samesite: "Lax"
  
  # CSRFä¿æŠ¤
  csrf_enabled: true
  csrf_token_timeout: 3600
  
  # é€Ÿç‡é™åˆ¶
  rate_limit:
    enabled: true
    requests_per_minute: 60
    requests_per_hour: 1000
  
  # æ•°æ®åŠ å¯†
  encryption_key: "${ENCRYPTION_KEY}"

# AIæœåŠ¡é…ç½®
ai_service:
  # ä¸»è¦æœåŠ¡å•†
  primary_provider: "deepseek"
  
  # DeepSeeké…ç½®
  deepseek:
    api_key: "${DEEPSEEK_API_KEY}"
    base_url: "https://api.deepseek.com"
    model: "deepseek-chat"
    timeout: 30
    max_retries: 3
  
  # å¤‡ç”¨æœåŠ¡å•†
  fallback_providers:
    - name: "zhipu"
      api_key: "${ZHIPU_API_KEY}"
      base_url: "https://open.bigmodel.cn/api/paas/v4/"
      model: "glm-4"
    
    - name: "baichuan"
      api_key: "${BAICHUAN_API_KEY}"
      base_url: "https://api.baichuan-ai.com/v1/"
      model: "Baichuan2-Turbo"
  
  # è¯·æ±‚é…ç½®
  max_tokens: 2000
  temperature: 0.7
  timeout: 30
  retry_delay: 1

# å†…å®¹çˆ¬å–é…ç½®
content_crawler:
  # çˆ¬å–é—´éš”
  refresh_interval: 86400  # 24å°æ—¶
  
  # å¹¶å‘è®¾ç½®
  max_concurrent_requests: 5
  request_delay: 1  # ç§’
  
  # è¶…æ—¶è®¾ç½®
  request_timeout: 30
  
  # ç”¨æˆ·ä»£ç†
  user_agent: "BilingualTutor/1.0 (+https://example.com/bot)"
  
  # å†…å®¹è´¨é‡é˜ˆå€¼
  quality_threshold: 0.7
  
  # å­˜å‚¨è®¾ç½®
  max_content_age: 2592000  # 30å¤©
  max_content_per_level: 1000

# ç›‘æ§é…ç½®
monitoring:
  # å¥åº·æ£€æŸ¥
  health_check:
    enabled: true
    endpoint: "/health"
    interval: 60  # ç§’
  
  # æ€§èƒ½ç›‘æ§
  performance:
    enabled: true
    sample_rate: 0.1  # 10%é‡‡æ ·
    slow_query_threshold: 1.0  # ç§’
  
  # é”™è¯¯ç›‘æ§
  error_tracking:
    enabled: true
    sample_rate: 1.0  # 100%é‡‡æ ·
  
  # æŒ‡æ ‡æ”¶é›†
  metrics:
    enabled: true
    endpoint: "/metrics"
    include_system_metrics: true

# å¤‡ä»½é…ç½®
backup:
  # æ•°æ®åº“å¤‡ä»½
  database:
    enabled: true
    schedule: "0 2 * * *"  # æ¯å¤©å‡Œæ™¨2ç‚¹
    retention_days: 30
    compression: true
  
  # æ—¥å¿—å¤‡ä»½
  logs:
    enabled: true
    schedule: "0 3 * * 0"  # æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹
    retention_weeks: 12
    compression: true
  
  # é…ç½®å¤‡ä»½
  config:
    enabled: true
    schedule: "0 4 * * 0"  # æ¯å‘¨æ—¥å‡Œæ™¨4ç‚¹
    retention_months: 6

# æ€§èƒ½ä¼˜åŒ–
performance:
  # è¿æ¥æ± 
  connection_pool:
    max_size: 20
    min_size: 5
    timeout: 30
  
  # ç¼“å­˜é¢„çƒ­
  cache_warmup:
    enabled: true
    on_startup: true
    popular_content_limit: 100
  
  # é™æ€æ–‡ä»¶
  static_files:
    cache_timeout: 86400  # 24å°æ—¶
    compression: true
    etag: true
  
  # æ•°æ®åº“ä¼˜åŒ–
  database_optimization:
    query_cache: true
    index_optimization: true
    vacuum_schedule: "0 1 * * 0"  # æ¯å‘¨æ—¥å‡Œæ™¨1ç‚¹

# é€šçŸ¥é…ç½®
notifications:
  # é‚®ä»¶é€šçŸ¥
  email:
    enabled: false
    smtp_host: "${SMTP_HOST}"
    smtp_port: "${SMTP_PORT:-587}"
    smtp_user: "${SMTP_USER}"
    smtp_password: "${SMTP_PASSWORD}"
    from_address: "${FROM_EMAIL}"
  
  # ç³»ç»Ÿé€šçŸ¥
  system:
    enabled: true
    log_errors: true
    alert_threshold: 10  # 10ä¸ªé”™è¯¯åå‘é€è­¦æŠ¥

# éƒ¨ç½²é…ç½®
deployment:
  # å®¹å™¨é…ç½®
  container:
    image: "bilingual-tutor:latest"
    restart_policy: "always"
    memory_limit: "2g"
    cpu_limit: "1.0"
  
  # å¥åº·æ£€æŸ¥
  health_check:
    test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
    interval: "30s"
    timeout: "10s"
    retries: 3
    start_period: "40s"
  
  # ç¯å¢ƒå˜é‡
  environment:
    - "FLASK_ENV=production"
    - "PYTHONPATH=/app"
    - "TZ=Asia/Shanghai"

# ç»´æŠ¤é…ç½®
maintenance:
  # ç»´æŠ¤çª—å£
  window:
    enabled: false
    start_time: "02:00"
    end_time: "04:00"
    timezone: "Asia/Shanghai"
  
  # è‡ªåŠ¨æ›´æ–°
  auto_update:
    enabled: false
    schedule: "0 3 * * 1"  # æ¯å‘¨ä¸€å‡Œæ™¨3ç‚¹
    backup_before_update: true
  
  # æ¸…ç†ä»»åŠ¡
  cleanup:
    temp_files: true
    old_logs: true
    expired_cache: true
    schedule: "0 5 * * *"  # æ¯å¤©å‡Œæ™¨5ç‚¹