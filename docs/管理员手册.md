# åŒè¯­å¯¼å¸ˆç³»ç»Ÿç®¡ç†å‘˜æ‰‹å†Œ

## âš ï¸ é‡è¦ç®¡ç†å£°æ˜

### ğŸš¨ ç³»ç»Ÿæ€§è´¨ä¸ç®¡ç†é™åˆ¶

**æœ¬ç³»ç»Ÿä¸¥æ ¼é™å®šä¸ºä¸ªäººå­¦ä¹ ç³»ç»Ÿï¼Œç®¡ç†å‘˜å¿…é¡»éµå®ˆä»¥ä¸‹ç®¡ç†è§„èŒƒï¼š**

- ğŸ“ **ä»…é™ä¸ªäººå­¦ä¹ ç³»ç»Ÿ**: æœ¬ç³»ç»Ÿä»…å¯éƒ¨ç½²å’Œç®¡ç†ç”¨äºä¸ªäººè¯­è¨€å­¦ä¹ ï¼Œä¸¥ç¦ç”¨äºä»»ä½•å•†ä¸šç›®çš„
- ğŸš« **ç¦æ­¢å•†ä¸šéƒ¨ç½²**: ä¸¥ç¦å°†ç³»ç»Ÿéƒ¨ç½²ç”¨äºå•†ä¸šåŸ¹è®­ã€ä¼ä¸šæœåŠ¡æˆ–ä»»ä½•ç›ˆåˆ©æ´»åŠ¨
- ğŸ“‹ **æ•°æ®ä½¿ç”¨é™åˆ¶**: ç³»ç»Ÿæ•°æ®ä»…å¯ç”¨äºä¸ªäººå­¦ä¹ åˆ†æï¼Œä¸å¾—ç”¨äºå•†ä¸šæ•°æ®æŒ–æ˜æˆ–åˆ†æ
- âš–ï¸ **æ³•å¾‹è´£ä»»**: ä»»ä½•è¿è§„éƒ¨ç½²æˆ–ç®¡ç†é€ æˆçš„æ³•å¾‹åæœç”±ç®¡ç†å‘˜è‡ªè¡Œæ‰¿æ‹…
- ğŸ›¡ï¸ **ç‰ˆæƒä¿æŠ¤**: ç®¡ç†å‘˜æœ‰è´£ä»»ç¡®ä¿ç³»ç»Ÿä½¿ç”¨ç¬¦åˆç›¸å…³ç‰ˆæƒå’Œæ³•å¾‹è§„å®š

### ğŸ”’ ç®¡ç†èŒè´£é™åˆ¶

- **ç”¨æˆ·ç®¡ç†**: ä»…å¯ç®¡ç†ä¸ªäººå­¦ä¹ è´¦æˆ·ï¼Œä¸æ¶‰åŠå•†ä¸šç”¨æˆ·ç®¡ç†
- **å†…å®¹ç®¡ç†**: ä»…å¯ç®¡ç†ä¸ªäººå­¦ä¹ å†…å®¹ï¼Œä¸æ¶‰åŠå•†ä¸šå†…å®¹åˆ†å‘
- **ç³»ç»Ÿç›‘æ§**: ä»…å¯ç›‘æ§ä¸ªäººå­¦ä¹ ç³»ç»Ÿæ€§èƒ½ï¼Œä¸æ¶‰åŠå•†ä¸šç³»ç»Ÿç›‘æ§

### âš ï¸ ç‰¹åˆ«æé†’

å¦‚å‘ç°ç³»ç»Ÿè¢«ç”¨äºå•†ä¸šç›®çš„æˆ–å…¶ä»–è¿è§„è¡Œä¸ºï¼Œç®¡ç†å‘˜æœ‰ä¹‰åŠ¡ç«‹å³åœæ­¢ç›¸å…³æœåŠ¡å¹¶æ‰¿æ‹…ç›¸åº”è´£ä»»ã€‚

## æ¦‚è¿°

æœ¬æ‰‹å†Œä¸ºåŒè¯­å¯¼å¸ˆç³»ç»Ÿçš„ç®¡ç†å‘˜æä¾›å®Œæ•´çš„ç³»ç»Ÿç®¡ç†ã€ç»´æŠ¤å’Œæ•…éšœæ’é™¤æŒ‡å—ã€‚ç³»ç»Ÿé‡‡ç”¨Python Flaskæ¡†æ¶æ„å»ºï¼Œä½¿ç”¨SQLiteæ•°æ®åº“å’ŒRedisç¼“å­˜ï¼Œæ”¯æŒLinuxå’ŒWindowséƒ¨ç½²ã€‚

## ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

- **Webåº”ç”¨å±‚**: Flaskåº”ç”¨ï¼Œæä¾›ç”¨æˆ·ç•Œé¢å’ŒAPI
- **æ ¸å¿ƒå¼•æ“**: å­¦ä¹ å¼•æ“ï¼Œåè°ƒå„ä¸ªåŠŸèƒ½æ¨¡å—
- **æ•°æ®å­˜å‚¨**: SQLiteæ•°æ®åº“ï¼Œå­˜å‚¨ç”¨æˆ·æ•°æ®å’Œå­¦ä¹ è®°å½•
- **ç¼“å­˜ç³»ç»Ÿ**: Redisç¼“å­˜ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½
- **AIæœåŠ¡**: é›†æˆå¤šä¸ªå›½å†…AIæ¨¡å‹æä¾›æ™ºèƒ½åŠŸèƒ½
- **å†…å®¹çˆ¬è™«**: è‡ªåŠ¨è·å–å’Œæ›´æ–°å­¦ä¹ å†…å®¹

### ç›®å½•ç»“æ„

```
/opt/bilingual-tutor/          # åº”ç”¨æ ¹ç›®å½•
â”œâ”€â”€ bilingual_tutor/           # ä¸»åº”ç”¨ä»£ç 
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data/                      # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ logs/                      # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ backups/                   # å¤‡ä»½æ–‡ä»¶
â”œâ”€â”€ scripts/                   # ç®¡ç†è„šæœ¬
â””â”€â”€ venv/                      # Pythonè™šæ‹Ÿç¯å¢ƒ
```

## ç³»ç»Ÿå®‰è£…å’Œéƒ¨ç½²

### Linuxç³»ç»Ÿéƒ¨ç½²

#### è‡ªåŠ¨éƒ¨ç½²

ä½¿ç”¨æä¾›çš„éƒ¨ç½²è„šæœ¬è¿›è¡Œä¸€é”®éƒ¨ç½²ï¼š

```bash
# ä¸‹è½½éƒ¨ç½²è„šæœ¬
wget https://example.com/deploy.sh

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x deploy.sh

# ä»¥rootæƒé™è¿è¡Œéƒ¨ç½²è„šæœ¬
sudo ./deploy.sh
```

#### æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

1. **ç³»ç»Ÿè¦æ±‚æ£€æŸ¥**
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬ï¼ˆéœ€è¦3.8+ï¼‰
python3 --version

# æ£€æŸ¥å¿…éœ€è½¯ä»¶åŒ…
sudo apt update
sudo apt install python3-pip python3-venv sqlite3 redis-server nginx curl git
```

2. **åˆ›å»ºåº”ç”¨ç”¨æˆ·**
```bash
sudo useradd --system --home-dir /opt/bilingual-tutor --shell /bin/bash bilingual-tutor
```

3. **åˆ›å»ºç›®å½•ç»“æ„**
```bash
sudo mkdir -p /opt/bilingual-tutor/{data,logs,backups,config,scripts}
sudo chown -R bilingual-tutor:bilingual-tutor /opt/bilingual-tutor
```

4. **å®‰è£…Pythonä¾èµ–**
```bash
cd /opt/bilingual-tutor
sudo -u bilingual-tutor python3 -m venv venv
sudo -u bilingual-tutor venv/bin/pip install -r requirements.txt
sudo -u bilingual-tutor venv/bin/pip install gunicorn
```

5. **é…ç½®æ•°æ®åº“**
```bash
sudo -u bilingual-tutor venv/bin/python -c "
from bilingual_tutor.storage.database import DatabaseManager
db = DatabaseManager('/opt/bilingual-tutor/data/learning.db')
db.initialize_database()
"
```

### Windowsç³»ç»Ÿéƒ¨ç½²

#### è‡ªåŠ¨éƒ¨ç½²

ä½¿ç”¨æä¾›çš„Windowséƒ¨ç½²è„šæœ¬ï¼š

```cmd
REM ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤æç¤ºç¬¦
REM ä¸‹è½½å¹¶è¿è¡Œéƒ¨ç½²è„šæœ¬
deploy.bat
```

#### æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

1. **å®‰è£…Python 3.8+**
   - ä» https://www.python.org/downloads/ ä¸‹è½½å®‰è£…
   - ç¡®ä¿æ·»åŠ åˆ°ç³»ç»ŸPATH

2. **åˆ›å»ºåº”ç”¨ç›®å½•**
```cmd
mkdir C:\bilingual-tutor
mkdir C:\bilingual-tutor\data
mkdir C:\bilingual-tutor\logs
mkdir C:\bilingual-tutor\backups
mkdir C:\bilingual-tutor\config
```

3. **å®‰è£…ä¾èµ–**
```cmd
cd C:\bilingual-tutor
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
pip install waitress pywin32
```

## é…ç½®ç®¡ç†

### ä¸»é…ç½®æ–‡ä»¶

ç³»ç»Ÿä½¿ç”¨YAMLæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œä½äº `config/production.yaml`ï¼š

```yaml
# åº”ç”¨åŸºç¡€é…ç½®
app:
  name: "åŒè¯­å¯¼å¸ˆç³»ç»Ÿ"
  version: "1.0.0"
  environment: "production"
  debug: false
  host: "0.0.0.0"
  port: 5000

# æ•°æ®åº“é…ç½®
database:
  type: "sqlite"
  path: "/app/data/learning.db"
  backup_interval: 86400

# ç¼“å­˜é…ç½®
cache:
  type: "redis"
  host: "localhost"
  port: 6379
  db: 0
```

### ç¯å¢ƒå˜é‡é…ç½®

é‡è¦çš„æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼š

```bash
# å¿…éœ€çš„ç¯å¢ƒå˜é‡
export SECRET_KEY="your-secret-key-here"
export ENCRYPTION_KEY="your-encryption-key-here"

# AIæœåŠ¡é…ç½®
export DEEPSEEK_API_KEY="your-deepseek-api-key"
export ZHIPU_API_KEY="your-zhipu-api-key"
export BAICHUAN_API_KEY="your-baichuan-api-key"

# æ•°æ®åº“é…ç½®ï¼ˆå¦‚æœä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼‰
export DATABASE_URL="sqlite:///app/data/learning.db"

# Redisé…ç½®ï¼ˆå¦‚æœä½¿ç”¨å¤–éƒ¨Redisï¼‰
export REDIS_HOST="localhost"
export REDIS_PORT="6379"
export REDIS_PASSWORD=""
```

### é…ç½®æ–‡ä»¶éªŒè¯

éªŒè¯é…ç½®æ–‡ä»¶æ ¼å¼å’Œå†…å®¹ï¼š

```bash
# éªŒè¯YAMLè¯­æ³•
python -c "import yaml; yaml.safe_load(open('config/production.yaml'))"

# éªŒè¯é…ç½®å®Œæ•´æ€§
python -c "
from bilingual_tutor.infrastructure.config_manager import ConfigManager
config = ConfigManager('config/production.yaml')
config.validate_config()
print('é…ç½®éªŒè¯é€šè¿‡')
"
```

## æœåŠ¡ç®¡ç†

### Linuxç³»ç»ŸæœåŠ¡ç®¡ç†

ç³»ç»Ÿä½¿ç”¨systemdç®¡ç†æœåŠ¡ï¼š

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status bilingual-tutor

# å¯åŠ¨æœåŠ¡
sudo systemctl start bilingual-tutor

# åœæ­¢æœåŠ¡
sudo systemctl stop bilingual-tutor

# é‡å¯æœåŠ¡
sudo systemctl restart bilingual-tutor

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload bilingual-tutor

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u bilingual-tutor -f

# å¯ç”¨å¼€æœºè‡ªå¯
sudo systemctl enable bilingual-tutor
```

### Windowsç³»ç»ŸæœåŠ¡ç®¡ç†

ç³»ç»Ÿæ³¨å†Œä¸ºWindowsæœåŠ¡ï¼š

```cmd
REM å¯åŠ¨æœåŠ¡
net start BilingualTutor

REM åœæ­¢æœåŠ¡
net stop BilingualTutor

REM æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sc query BilingualTutor

REM æœåŠ¡ç®¡ç†ç•Œé¢
services.msc
```

### æœåŠ¡é…ç½®æ–‡ä»¶

Linux systemdæœåŠ¡é…ç½® (`/etc/systemd/system/bilingual-tutor.service`)ï¼š

```ini
[Unit]
Description=åŒè¯­å¯¼å¸ˆç³»ç»Ÿ
After=network.target redis.service

[Service]
Type=exec
User=bilingual-tutor
WorkingDirectory=/opt/bilingual-tutor
Environment=FLASK_ENV=production
ExecStart=/opt/bilingual-tutor/venv/bin/gunicorn \
    --bind 127.0.0.1:5000 \
    --workers 4 \
    --timeout 30 \
    bilingual_tutor.web.app:app
Restart=always

[Install]
WantedBy=multi-user.target
```

## æ•°æ®åº“ç®¡ç†

### æ•°æ®åº“ç»“æ„

ç³»ç»Ÿä½¿ç”¨SQLiteæ•°æ®åº“ï¼Œä¸»è¦è¡¨ç»“æ„ï¼š

- `users`: ç”¨æˆ·ä¿¡æ¯è¡¨
- `user_profiles`: ç”¨æˆ·å­¦ä¹ æ¡£æ¡ˆ
- `study_sessions`: å­¦ä¹ ä¼šè¯è®°å½•
- `learning_activities`: å­¦ä¹ æ´»åŠ¨è®°å½•
- `content_items`: å­¦ä¹ å†…å®¹è¡¨
- `vocabulary_tracking`: è¯æ±‡è·Ÿè¸ªè¡¨
- `progress_records`: è¿›åº¦è®°å½•è¡¨

### æ•°æ®åº“æ“ä½œ

#### æ•°æ®åº“å¤‡ä»½

```bash
# æ‰‹åŠ¨å¤‡ä»½
sqlite3 /opt/bilingual-tutor/data/learning.db ".backup /opt/bilingual-tutor/backups/learning_$(date +%Y%m%d_%H%M%S).db"

# å‹ç¼©å¤‡ä»½
gzip /opt/bilingual-tutor/backups/learning_$(date +%Y%m%d_%H%M%S).db

# è‡ªåŠ¨å¤‡ä»½è„šæœ¬å·²é…ç½®ä¸ºæ¯æ—¥å‡Œæ™¨2ç‚¹è¿è¡Œ
```

#### æ•°æ®åº“æ¢å¤

```bash
# ä»å¤‡ä»½æ¢å¤
cp /opt/bilingual-tutor/backups/learning_backup.db /opt/bilingual-tutor/data/learning.db

# è§£å‹ç¼©å¤‡ä»½
gunzip /opt/bilingual-tutor/backups/learning_backup.db.gz
cp /opt/bilingual-tutor/backups/learning_backup.db /opt/bilingual-tutor/data/learning.db

# é‡å¯æœåŠ¡
sudo systemctl restart bilingual-tutor
```

#### æ•°æ®åº“ç»´æŠ¤

```bash
# æ•°æ®åº“ä¼˜åŒ–
sqlite3 /opt/bilingual-tutor/data/learning.db "VACUUM;"

# é‡å»ºç´¢å¼•
sqlite3 /opt/bilingual-tutor/data/learning.db "REINDEX;"

# æ£€æŸ¥æ•°æ®åº“å®Œæ•´æ€§
sqlite3 /opt/bilingual-tutor/data/learning.db "PRAGMA integrity_check;"

# æŸ¥çœ‹æ•°æ®åº“ç»Ÿè®¡
sqlite3 /opt/bilingual-tutor/data/learning.db ".schema"
```

### æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–

#### ç´¢å¼•ç®¡ç†

```sql
-- æŸ¥çœ‹ç°æœ‰ç´¢å¼•
.indices

-- åˆ›å»ºæ€§èƒ½ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_users_email ON users(email);
CREATE INDEX IF NOT EXISTS idx_sessions_user_date ON study_sessions(user_id, created_at);
CREATE INDEX IF NOT EXISTS idx_activities_session ON learning_activities(session_id);
CREATE INDEX IF NOT EXISTS idx_content_level ON content_items(language, difficulty_level);
```

#### æŸ¥è¯¢ä¼˜åŒ–

```sql
-- åˆ†ææŸ¥è¯¢è®¡åˆ’
EXPLAIN QUERY PLAN SELECT * FROM study_sessions WHERE user_id = 1;

-- ç»Ÿè®¡ä¿¡æ¯æ›´æ–°
ANALYZE;
```

## ç¼“å­˜ç®¡ç†

### Redisç¼“å­˜ç®¡ç†

#### ç¼“å­˜ç›‘æ§

```bash
# è¿æ¥Redis
redis-cli

# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
INFO stats

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
INFO memory

# æŸ¥çœ‹æ‰€æœ‰é”®
KEYS *

# æŸ¥çœ‹ç‰¹å®šæ¨¡å¼çš„é”®
KEYS bilingual_tutor:*

# æ¸…ç©ºç¼“å­˜
FLUSHDB
```

#### ç¼“å­˜é…ç½®ä¼˜åŒ–

Redisé…ç½®æ–‡ä»¶ (`/etc/redis/redis.conf`)ï¼š

```conf
# å†…å­˜é™åˆ¶
maxmemory 512mb

# å†…å­˜å›æ”¶ç­–ç•¥
maxmemory-policy allkeys-lru

# æŒä¹…åŒ–é…ç½®
save 900 1
save 300 10
save 60 10000

# æ—¥å¿—çº§åˆ«
loglevel notice
```

### ç¼“å­˜ç­–ç•¥ç®¡ç†

#### ç¼“å­˜é¢„çƒ­

```python
# ç¼“å­˜é¢„çƒ­è„šæœ¬
from bilingual_tutor.infrastructure.cache_manager import CacheManager

cache = CacheManager()
cache.warmup_cache()
print("ç¼“å­˜é¢„çƒ­å®Œæˆ")
```

#### ç¼“å­˜æ¸…ç†

```bash
# æ¸…ç†è¿‡æœŸç¼“å­˜
python -c "
from bilingual_tutor.infrastructure.cache_manager import CacheManager
cache = CacheManager()
cache.cleanup_expired_cache()
print('è¿‡æœŸç¼“å­˜æ¸…ç†å®Œæˆ')
"
```

## æ—¥å¿—ç®¡ç†

### æ—¥å¿—æ–‡ä»¶ä½ç½®

- **åº”ç”¨æ—¥å¿—**: `/opt/bilingual-tutor/logs/bilingual_tutor.log`
- **é”™è¯¯æ—¥å¿—**: `/opt/bilingual-tutor/logs/error.log`
- **è®¿é—®æ—¥å¿—**: `/opt/bilingual-tutor/logs/gunicorn_access.log`
- **Nginxæ—¥å¿—**: `/opt/bilingual-tutor/logs/nginx_access.log`
- **ç³»ç»Ÿæ—¥å¿—**: `/var/log/syslog` (Linux) æˆ–äº‹ä»¶æŸ¥çœ‹å™¨ (Windows)

### æ—¥å¿—çº§åˆ«é…ç½®

åœ¨é…ç½®æ–‡ä»¶ä¸­è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼š

```yaml
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  
  file:
    enabled: true
    level: "INFO"
  
  console:
    enabled: true
    level: "WARNING"
  
  error:
    enabled: true
    level: "ERROR"
```

### æ—¥å¿—åˆ†æ

#### å¸¸ç”¨æ—¥å¿—åˆ†æå‘½ä»¤

```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f /opt/bilingual-tutor/logs/bilingual_tutor.log

# æœç´¢é”™è¯¯æ—¥å¿—
grep "ERROR" /opt/bilingual-tutor/logs/bilingual_tutor.log

# ç»Ÿè®¡é”™è¯¯æ•°é‡
grep -c "ERROR" /opt/bilingual-tutor/logs/bilingual_tutor.log

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µçš„æ—¥å¿—
grep "2025-01-02" /opt/bilingual-tutor/logs/bilingual_tutor.log

# åˆ†æè®¿é—®æ—¥å¿—
awk '{print $1}' /opt/bilingual-tutor/logs/nginx_access.log | sort | uniq -c | sort -nr
```

#### æ—¥å¿—è½®è½¬é…ç½®

ç³»ç»Ÿå·²é…ç½®logrotateè¿›è¡Œæ—¥å¿—è½®è½¬ï¼š

```conf
/opt/bilingual-tutor/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 bilingual-tutor bilingual-tutor
    postrotate
        systemctl reload bilingual-tutor > /dev/null 2>&1 || true
    endscript
}
```

## ç›‘æ§å’Œå‘Šè­¦

### ç³»ç»Ÿç›‘æ§

#### å¥åº·æ£€æŸ¥

```bash
# HTTPå¥åº·æ£€æŸ¥
curl -f http://localhost/health

# è¯¦ç»†å¥åº·æ£€æŸ¥
curl -s http://localhost/health | jq .

# æœåŠ¡çŠ¶æ€æ£€æŸ¥
systemctl is-active bilingual-tutor
```

#### æ€§èƒ½ç›‘æ§

```bash
# ç³»ç»Ÿèµ„æºç›‘æ§
top -p $(pgrep -f bilingual-tutor)

# å†…å­˜ä½¿ç”¨ç›‘æ§
ps aux | grep bilingual-tutor

# ç£ç›˜ä½¿ç”¨ç›‘æ§
df -h /opt/bilingual-tutor

# ç½‘ç»œè¿æ¥ç›‘æ§
netstat -tlnp | grep :5000
```

### å‘Šè­¦é…ç½®

ç›‘æ§é…ç½®æ–‡ä»¶ä½äº `config/monitoring.yaml`ï¼ŒåŒ…å«ï¼š

- **ç³»ç»Ÿèµ„æºå‘Šè­¦**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
- **åº”ç”¨æ€§èƒ½å‘Šè­¦**: å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **æœåŠ¡å¯ç”¨æ€§å‘Šè­¦**: æœåŠ¡çŠ¶æ€ã€æ•°æ®åº“è¿æ¥
- **ä¸šåŠ¡æŒ‡æ ‡å‘Šè­¦**: ç”¨æˆ·æ´»åŠ¨ã€å­¦ä¹ æ•ˆæœ

#### å‘Šè­¦é€šçŸ¥æ–¹å¼

1. **æ—¥å¿—è®°å½•**: æ‰€æœ‰å‘Šè­¦è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶
2. **é‚®ä»¶é€šçŸ¥**: é…ç½®SMTPå‘é€å‘Šè­¦é‚®ä»¶
3. **ç³»ç»Ÿé€šçŸ¥**: Windowsé€šçŸ¥æˆ–Linux syslog
4. **Webhook**: å‘é€åˆ°å¤–éƒ¨ç›‘æ§ç³»ç»Ÿ

### è‡ªåŠ¨ç›‘æ§è„šæœ¬

ç³»ç»ŸåŒ…å«è‡ªåŠ¨ç›‘æ§è„šæœ¬ï¼š

- **Linux**: `/opt/bilingual-tutor/scripts/monitor.sh`
- **Windows**: `C:\bilingual-tutor\scripts\monitor.bat`

ç›‘æ§è„šæœ¬æ¯5åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ï¼Œæ£€æŸ¥ï¼š
- æœåŠ¡è¿è¡ŒçŠ¶æ€
- HTTPå“åº”æ­£å¸¸
- æ•°æ®åº“è¿æ¥
- ç¼“å­˜æœåŠ¡çŠ¶æ€

## å¤‡ä»½å’Œæ¢å¤

### è‡ªåŠ¨å¤‡ä»½

ç³»ç»Ÿé…ç½®äº†è‡ªåŠ¨å¤‡ä»½ä»»åŠ¡ï¼š

#### Linux cronä»»åŠ¡

```bash
# æŸ¥çœ‹å½“å‰å¤‡ä»½ä»»åŠ¡
crontab -u bilingual-tutor -l

# å¤‡ä»½ä»»åŠ¡é…ç½®
0 2 * * * /opt/bilingual-tutor/scripts/backup.sh >> /opt/bilingual-tutor/logs/backup.log 2>&1
```

#### Windowsè®¡åˆ’ä»»åŠ¡

```cmd
REM æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡
schtasks /query /tn "åŒè¯­å¯¼å¸ˆç³»ç»Ÿå¤‡ä»½"

REM æ‰‹åŠ¨è¿è¡Œå¤‡ä»½
schtasks /run /tn "åŒè¯­å¯¼å¸ˆç³»ç»Ÿå¤‡ä»½"
```

### å¤‡ä»½å†…å®¹

è‡ªåŠ¨å¤‡ä»½åŒ…æ‹¬ï¼š

1. **æ•°æ®åº“æ–‡ä»¶**: SQLiteæ•°æ®åº“å®Œæ•´å¤‡ä»½
2. **é…ç½®æ–‡ä»¶**: ç³»ç»Ÿé…ç½®æ–‡ä»¶å¤‡ä»½
3. **æ—¥å¿—æ–‡ä»¶**: é‡è¦æ—¥å¿—æ–‡ä»¶å¤‡ä»½
4. **ç”¨æˆ·æ•°æ®**: ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å’Œæ•°æ®

### å¤‡ä»½ç­–ç•¥

- **æ¯æ—¥å¤‡ä»½**: æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶
- **æ¯å‘¨å¤‡ä»½**: å®Œæ•´ç³»ç»Ÿå¤‡ä»½
- **ä¿ç•™ç­–ç•¥**: 
  - æ—¥å¤‡ä»½ä¿ç•™30å¤©
  - å‘¨å¤‡ä»½ä¿ç•™12å‘¨
  - æœˆå¤‡ä»½ä¿ç•™6ä¸ªæœˆ

### æ¢å¤æµç¨‹

#### æ•°æ®åº“æ¢å¤

```bash
# 1. åœæ­¢æœåŠ¡
sudo systemctl stop bilingual-tutor

# 2. å¤‡ä»½å½“å‰æ•°æ®åº“
cp /opt/bilingual-tutor/data/learning.db /opt/bilingual-tutor/data/learning.db.backup

# 3. æ¢å¤æ•°æ®åº“
cp /opt/bilingual-tutor/backups/learning_20250102_020000.db /opt/bilingual-tutor/data/learning.db

# 4. è®¾ç½®æƒé™
chown bilingual-tutor:bilingual-tutor /opt/bilingual-tutor/data/learning.db

# 5. å¯åŠ¨æœåŠ¡
sudo systemctl start bilingual-tutor

# 6. éªŒè¯æ¢å¤
curl -f http://localhost/health
```

#### å®Œæ•´ç³»ç»Ÿæ¢å¤

```bash
# 1. åœæ­¢æ‰€æœ‰æœåŠ¡
sudo systemctl stop bilingual-tutor nginx redis

# 2. æ¢å¤åº”ç”¨æ–‡ä»¶
tar -xzf /opt/bilingual-tutor/backups/system_backup_20250102.tar.gz -C /

# 3. æ¢å¤æ•°æ®åº“
cp /opt/bilingual-tutor/backups/learning_20250102.db /opt/bilingual-tutor/data/learning.db

# 4. æ¢å¤é…ç½®æ–‡ä»¶
cp /opt/bilingual-tutor/backups/config_20250102.tar.gz /opt/bilingual-tutor/config/

# 5. è®¾ç½®æƒé™
chown -R bilingual-tutor:bilingual-tutor /opt/bilingual-tutor

# 6. å¯åŠ¨æœåŠ¡
sudo systemctl start redis nginx bilingual-tutor
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜è¯Šæ–­

#### æœåŠ¡æ— æ³•å¯åŠ¨

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**
```bash
sudo systemctl status bilingual-tutor
sudo journalctl -u bilingual-tutor -n 50
```

2. **æ£€æŸ¥é…ç½®æ–‡ä»¶**
```bash
python -c "import yaml; yaml.safe_load(open('config/production.yaml'))"
```

3. **æ£€æŸ¥ç«¯å£å ç”¨**
```bash
netstat -tlnp | grep :5000
```

4. **æ£€æŸ¥æ–‡ä»¶æƒé™**
```bash
ls -la /opt/bilingual-tutor/data/
```

#### æ•°æ®åº“è¿æ¥é—®é¢˜

1. **æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶**
```bash
ls -la /opt/bilingual-tutor/data/learning.db
sqlite3 /opt/bilingual-tutor/data/learning.db "SELECT 1;"
```

2. **æ£€æŸ¥æ•°æ®åº“é”å®š**
```bash
lsof /opt/bilingual-tutor/data/learning.db
```

3. **æ•°æ®åº“ä¿®å¤**
```bash
sqlite3 /opt/bilingual-tutor/data/learning.db "PRAGMA integrity_check;"
```

#### ç¼“å­˜è¿æ¥é—®é¢˜

1. **æ£€æŸ¥RedisæœåŠ¡**
```bash
sudo systemctl status redis-server
redis-cli ping
```

2. **æ£€æŸ¥Redisé…ç½®**
```bash
redis-cli CONFIG GET "*"
```

3. **æ¸…ç†ç¼“å­˜**
```bash
redis-cli FLUSHDB
```

#### æ€§èƒ½é—®é¢˜

1. **æ£€æŸ¥ç³»ç»Ÿèµ„æº**
```bash
top
free -h
df -h
iostat -x 1
```

2. **æ£€æŸ¥åº”ç”¨æ€§èƒ½**
```bash
# æŸ¥çœ‹æ…¢æŸ¥è¯¢
grep "slow" /opt/bilingual-tutor/logs/bilingual_tutor.log

# æ£€æŸ¥å†…å­˜æ³„æ¼
ps aux | grep bilingual-tutor
```

3. **ä¼˜åŒ–å»ºè®®**
- å¢åŠ workerè¿›ç¨‹æ•°
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
- è°ƒæ•´ç¼“å­˜ç­–ç•¥
- å‡çº§ç¡¬ä»¶é…ç½®

### é”™è¯¯ä»£ç å‚è€ƒ

#### HTTPé”™è¯¯ä»£ç 

- **500 å†…éƒ¨æœåŠ¡å™¨é”™è¯¯**: æ£€æŸ¥åº”ç”¨æ—¥å¿—å’Œé…ç½®
- **502 ç½‘å…³é”™è¯¯**: æ£€æŸ¥åº”ç”¨æœåŠ¡æ˜¯å¦è¿è¡Œ
- **503 æœåŠ¡ä¸å¯ç”¨**: æ£€æŸ¥ç³»ç»Ÿèµ„æºå’Œè´Ÿè½½
- **504 ç½‘å…³è¶…æ—¶**: æ£€æŸ¥åº”ç”¨å“åº”æ—¶é—´

#### åº”ç”¨é”™è¯¯ä»£ç 

- **DB_CONNECTION_ERROR**: æ•°æ®åº“è¿æ¥å¤±è´¥
- **CACHE_CONNECTION_ERROR**: ç¼“å­˜è¿æ¥å¤±è´¥
- **AI_SERVICE_ERROR**: AIæœåŠ¡è°ƒç”¨å¤±è´¥
- **CONFIG_ERROR**: é…ç½®æ–‡ä»¶é”™è¯¯

### ç´§æ€¥æ¢å¤æµç¨‹

#### æœåŠ¡å®Œå…¨ä¸å¯ç”¨

1. **ç«‹å³æ£€æŸ¥**
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status bilingual-tutor nginx redis

# æ£€æŸ¥ç³»ç»Ÿèµ„æº
df -h
free -h
```

2. **å¿«é€Ÿæ¢å¤**
```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
sudo systemctl restart redis nginx bilingual-tutor

# å¦‚æœä»ç„¶å¤±è´¥ï¼Œä»å¤‡ä»½æ¢å¤
sudo systemctl stop bilingual-tutor
cp /opt/bilingual-tutor/backups/learning_latest.db /opt/bilingual-tutor/data/learning.db
sudo systemctl start bilingual-tutor
```

3. **éªŒè¯æ¢å¤**
```bash
curl -f http://localhost/health
```

## å®‰å…¨ç®¡ç†

### å®‰å…¨é…ç½®

#### ç³»ç»Ÿå®‰å…¨

1. **é˜²ç«å¢™é…ç½®**
```bash
# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€
sudo ufw status

# å…è®¸å¿…è¦ç«¯å£
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw allow 443/tcp  # HTTPS
```

2. **SSL/TLSé…ç½®**
```bash
# å®‰è£…SSLè¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
0 12 * * * /usr/bin/certbot renew --quiet
```

#### åº”ç”¨å®‰å…¨

1. **å¯†ç å®‰å…¨**
- ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥
- å®šæœŸæ›´æ¢å¯†é’¥
- åŠ å¯†æ•æ„Ÿæ•°æ®

2. **è®¿é—®æ§åˆ¶**
- é™åˆ¶ç®¡ç†å‘˜è®¿é—®
- å®æ–½IPç™½åå•
- å¯ç”¨å®¡è®¡æ—¥å¿—

3. **æ•°æ®ä¿æŠ¤**
- å®šæœŸå¤‡ä»½æ•°æ®
- åŠ å¯†ä¼ è¾“é€šé“
- ä¿æŠ¤ç”¨æˆ·éšç§

### å®‰å…¨å®¡è®¡

#### å®šæœŸæ£€æŸ¥é¡¹ç›®

1. **ç³»ç»Ÿæ›´æ–°**
```bash
# æ£€æŸ¥ç³»ç»Ÿæ›´æ–°
sudo apt update && sudo apt list --upgradable

# æ›´æ–°ç³»ç»ŸåŒ…
sudo apt upgrade
```

2. **å®‰å…¨æ‰«æ**
```bash
# æ£€æŸ¥å¼€æ”¾ç«¯å£
nmap localhost

# æ£€æŸ¥æ–‡ä»¶æƒé™
find /opt/bilingual-tutor -type f -perm /o+w

# æ£€æŸ¥æ—¥å¿—å¼‚å¸¸
grep -i "failed\|error\|attack" /var/log/auth.log
```

3. **é…ç½®å®¡è®¡**
- æ£€æŸ¥ç”¨æˆ·æƒé™è®¾ç½®
- éªŒè¯é˜²ç«å¢™è§„åˆ™
- å®¡æŸ¥SSLè¯ä¹¦æœ‰æ•ˆæœŸ

## æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–

#### æ•°æ®åº“ä¼˜åŒ–

1. **ç´¢å¼•ä¼˜åŒ–**
```sql
-- åˆ†ææŸ¥è¯¢æ€§èƒ½
EXPLAIN QUERY PLAN SELECT * FROM study_sessions WHERE user_id = ?;

-- åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX idx_sessions_user_date ON study_sessions(user_id, created_at);
```

2. **æŸ¥è¯¢ä¼˜åŒ–**
```python
# ä½¿ç”¨æ‰¹é‡æ“ä½œ
def batch_insert_activities(activities):
    with db.get_connection() as conn:
        conn.executemany(
            "INSERT INTO learning_activities (...) VALUES (...)",
            activities
        )
```

#### ç¼“å­˜ä¼˜åŒ–

1. **ç¼“å­˜ç­–ç•¥è°ƒæ•´**
```yaml
cache:
  default_ttl: 3600      # å¢åŠ ç¼“å­˜æ—¶é—´
  max_connections: 100   # å¢åŠ è¿æ¥æ± 
  memory_limit: "1g"     # å¢åŠ å†…å­˜é™åˆ¶
```

2. **ç¼“å­˜é¢„çƒ­**
```python
# å¯åŠ¨æ—¶é¢„çƒ­å¸¸ç”¨æ•°æ®
def warmup_cache():
    cache.set("popular_content", get_popular_content())
    cache.set("user_preferences", get_default_preferences())
```

#### åº”ç”¨ä¼˜åŒ–

1. **å¹¶å‘å¤„ç†**
```yaml
# Gunicorné…ç½®ä¼˜åŒ–
workers: 4                    # CPUæ ¸å¿ƒæ•°
worker_connections: 1000      # æ¯ä¸ªworkerçš„è¿æ¥æ•°
timeout: 30                   # è¯·æ±‚è¶…æ—¶æ—¶é—´
keepalive: 2                  # ä¿æŒè¿æ¥æ—¶é—´
```

2. **é™æ€æ–‡ä»¶ä¼˜åŒ–**
```nginx
# Nginxé™æ€æ–‡ä»¶ç¼“å­˜
location /static/ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    gzip on;
    gzip_types text/css application/javascript;
}
```

### ç›‘æ§æ€§èƒ½æŒ‡æ ‡

#### å…³é”®æŒ‡æ ‡

1. **å“åº”æ—¶é—´**: ç›®æ ‡ < 2ç§’
2. **å¹¶å‘ç”¨æˆ·**: æ”¯æŒ100+å¹¶å‘
3. **æ•°æ®åº“æŸ¥è¯¢**: å¹³å‡ < 100ms
4. **ç¼“å­˜å‘½ä¸­ç‡**: > 80%
5. **é”™è¯¯ç‡**: < 1%

#### æ€§èƒ½æµ‹è¯•

```bash
# å‹åŠ›æµ‹è¯•
ab -n 1000 -c 10 http://localhost/

# æ•°æ®åº“æ€§èƒ½æµ‹è¯•
sqlite3 /opt/bilingual-tutor/data/learning.db ".timer on" "SELECT COUNT(*) FROM users;"
```

## ç»´æŠ¤è®¡åˆ’

### æ—¥å¸¸ç»´æŠ¤

#### æ¯æ—¥æ£€æŸ¥

- [ ] æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€
- [ ] æŸ¥çœ‹é”™è¯¯æ—¥å¿—
- [ ] ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨
- [ ] éªŒè¯å¤‡ä»½å®Œæˆ

#### æ¯å‘¨ç»´æŠ¤

- [ ] æ¸…ç†ä¸´æ—¶æ–‡ä»¶
- [ ] ä¼˜åŒ–æ•°æ®åº“
- [ ] æ›´æ–°å†…å®¹ç¼“å­˜
- [ ] æ£€æŸ¥å®‰å…¨æ—¥å¿—

#### æ¯æœˆç»´æŠ¤

- [ ] ç³»ç»Ÿå®‰å…¨æ›´æ–°
- [ ] æ€§èƒ½æŠ¥å‘Šåˆ†æ
- [ ] å¤‡ä»½ç­–ç•¥è¯„ä¼°
- [ ] å®¹é‡è§„åˆ’æ£€æŸ¥

### å‡çº§ç»´æŠ¤

#### åº”ç”¨å‡çº§æµç¨‹

1. **å‡†å¤‡é˜¶æ®µ**
```bash
# åˆ›å»ºå®Œæ•´å¤‡ä»½
/opt/bilingual-tutor/scripts/backup.sh

# æµ‹è¯•æ–°ç‰ˆæœ¬
git clone https://github.com/example/bilingual-tutor.git /tmp/new-version
```

2. **å‡çº§æ‰§è¡Œ**
```bash
# åœæ­¢æœåŠ¡
sudo systemctl stop bilingual-tutor

# å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp -r /opt/bilingual-tutor /opt/bilingual-tutor.backup

# éƒ¨ç½²æ–°ç‰ˆæœ¬
cp -r /tmp/new-version/* /opt/bilingual-tutor/

# æ›´æ–°ä¾èµ–
source /opt/bilingual-tutor/venv/bin/activate
pip install -r requirements.txt

# æ•°æ®åº“è¿ç§»ï¼ˆå¦‚éœ€è¦ï¼‰
python migrate_database.py
```

3. **éªŒè¯å’Œå›æ»š**
```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start bilingual-tutor

# éªŒè¯åŠŸèƒ½
curl -f http://localhost/health

# å¦‚æœå¤±è´¥ï¼Œå›æ»š
sudo systemctl stop bilingual-tutor
rm -rf /opt/bilingual-tutor
mv /opt/bilingual-tutor.backup /opt/bilingual-tutor
sudo systemctl start bilingual-tutor
```

## è”ç³»ä¿¡æ¯

### æŠ€æœ¯æ”¯æŒ

- **ç³»ç»Ÿç®¡ç†å‘˜**: admin@example.com
- **æŠ€æœ¯æ”¯æŒ**: support@example.com
- **ç´§æ€¥è”ç³»**: +86-xxx-xxxx-xxxx

### æ–‡æ¡£æ›´æ–°

- **ç‰ˆæœ¬**: v1.0.0
- **æ›´æ–°æ—¥æœŸ**: 2025å¹´1æœˆ2æ—¥
- **ä¸‹æ¬¡å®¡æŸ¥**: 2025å¹´4æœˆ2æ—¥

---

æœ¬æ‰‹å†Œæ¶µç›–äº†åŒè¯­å¯¼å¸ˆç³»ç»Ÿçš„å®Œæ•´ç®¡ç†æµç¨‹ã€‚å¦‚æœ‰ç–‘é—®æˆ–éœ€è¦æŠ€æœ¯æ”¯æŒï¼Œè¯·åŠæ—¶è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚